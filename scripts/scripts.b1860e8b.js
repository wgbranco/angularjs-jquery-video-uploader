"use strict";angular.module("myApp",["ngMaterial","ngMessages"]),angular.module("myApp").factory("videoUploadService",["$rootScope",function(a){function b(){$("#fileupload").fileupload().bind("fileuploadstart",e).bind("fileuploadprogressall",f).bind("fileuploaddone",g).bind("fileuploadfail",h),c()}function c(){l=[],m=[],n=[],o=[]}function d(a){a&&(l.push(a.start),m.push(a.progress),n.push(a.done),o.push(a.fail))}function e(b,c){l.forEach(function(d){a.$apply(d(b,c))})}function f(b,c){m.forEach(function(d){a.$apply(d(b,c))})}function g(b,c){n.forEach(function(d){a.$apply(d(b,c))})}function h(b,c){o.forEach(function(d){a.$apply(d(b,c))})}function i(a){a&&$("#fileupload").fileupload("send",{url:j,type:"POST",multipart:!0,paramName:"file",progressInterval:250,autoUpload:!1,formData:{api_password:k},files:[a]})}var j="https://upload.wistia.com",k="8d090944caf0a683d4e2daa0b0e555f0faa528d3373410e44972ad4fba71b7ed",l=[],m=[],n=[],o=[];return b(),{setCallbacks:d,sendVideo:i}}]),angular.module("myApp").component("videoInputComponent",{templateUrl:"views/video-input-component.html",bindings:{pending:"<",fileSelected:"&"},controller:function(a){var b=this;b.$onInit=function(){var c=document.getElementById("file_select");c.addEventListener("click",function(){d.click()});var d=document.createElement("input");d.type="file",d.accept=".mp4",d.onchange=function(){var c=d.files[0];c&&(b.fileName=c.name,b.fileSelected({file:c}),a.$apply())},b.$onChanges=function(){b.pending||(b.fileName=void 0)}}}}),angular.module("myApp").component("videoUploadComponent",{templateUrl:"views/video-upload-component.html",bindings:{},controller:function(a,b,c){var d=this;d.$onInit=function(){d.uploading=!1,c.setCallbacks({start:d.onUploadStart,progress:d.onUploadProgress,done:d.onUploadDone,fail:d.onUploadFail})},d.onUploadStart=function(a,b){d.uploadPercentage=0,d.uploading=!0},d.onUploadProgress=function(a,b){d.uploadPercentage=parseInt(b.loaded/b.total*100,10)},d.onUploadDone=function(a,b){d.uploading=!1;var c=b._response.result;d.addToUploadedList(c),d.showToast("Video uploaded successfully!")},d.addToUploadedList=function(a){a&&(d.uploads||(d.uploads=[]),d.uploads.push(a))},d.onUploadFail=function(a,b){d.uploading=!1,d.showToast("Something went wrong :(")},d.onVideoSelected=function(a){c.sendVideo(a)},d.showToast=function(a){a&&a.length&&b.show(b.simple().textContent(a).position("top right").hideDelay(3e3))}}}),angular.module("myApp").component("uploadListComponent",{templateUrl:"views/upload-list-component.html",bindings:{uploads:"<"},controller:function(){}}),angular.module("myApp").component("uploadItemComponent",{templateUrl:"views/upload-item-component.html",bindings:{item:"<"},controller:function(){var a=this;a.$onChanges=function(){a.videoId=a.item.hashed_id,a.videoName=a.item.name,a.videoIdClass="wistia_async_"+a.videoId,a.thumbnailUrl=a.item.thumbnail.url}}}),angular.module("myApp").run(["$templateCache",function(a){a.put("views/upload-item-component.html",'<div class="vertical_box"> <!-- <img src="{{$ctrl.thumbnailUrl}}"> --> <!-- Header with icon and title --> <div class="horizontal_box video-title"> <md-icon class="material-icons">videocam</md-icon> <span>{{$ctrl.videoName}}</span> </div> <!-- Wistia player container --> <div ng-show="$ctrl.videoId" class="wistia_responsive_padding" style="padding:56.25% 0 0 0;position:relative"> <div class="wistia_responsive_wrapper" style="height:100%;left:0;position:absolute;top:0;width:100%"> <div class="wistia_embed videoFoam=true" ng-class="$ctrl.videoIdClass" style="height:100%;width:100%"> &nbsp; </div> </div> </div> </div>'),a.put("views/upload-list-component.html",'<md-list> <md-list-item class="md-2-line no-padding-no-margin" ng-repeat="upload in $ctrl.uploads track by $index"> <upload-item-component item="upload" class="upload_item"> </upload-item-component> </md-list-item> </md-list>'),a.put("views/video-input-component.html",'<div id="container" class="horizontal_box"> <md-button id="file_select" title="Choose a video file to upload" class="md-fab md-raised md-mini no-padding-no-margin" ng-disabled="$ctrl.pending"> <md-icon class="material-icons">cloud_upload</md-icon> </md-button> <md-input-container class="file-name-container no-padding-no-margin"> <input type="text" aria-label="File name" value="{{$ctrl.fileName}}" readonly> </md-input-container> </div>'),a.put("views/video-upload-component.html",'<div class="main_container vertical_box"> <!-- File selection form --> <form id="fileupload"> <video-input-component pending="$ctrl.uploading" file-selected="$ctrl.onVideoSelected(file)"> </video-input-component> </form> <!-- Upload progress bar --> <md-progress-linear md-mode="determinate" ng-if="$ctrl.uploading" value="{{$ctrl.uploadPercentage}}"> </md-progress-linear> <!-- List of uploaded files --> <upload-list-component uploads="$ctrl.uploads"> </upload-list-component> </div>')}]);